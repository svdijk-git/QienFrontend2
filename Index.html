<html>
  <head>
    <link rel="stylesheet" type="text/css" href="mystyle.css" />
    <h1 id="titelBovenaan">Placeholder: website Qien</h1>
    ADMIN MODUS
  </head>
  <script src="jquerycode.js"></script>
  <body>
    <h4 id="titel">TOEVOEGEN WERKNEMER</h4>

    <div id="persoon"></div>
    <div id="verwijderPersoon">
      <input type="text" id="delGb" />
      <button id="del" onclick="deleteGebruiker()">verwijderPersoon</button>
    </div>

    <div id="updatePersoon">
      <input type="text" id="upPersoon" />
      <button id="upButton" onclick="updateGebruiker()">aanpassing</button>
    </div>
    <div>
      <button onclick="Getpersoon()">GET</button>
      <br /><br />
      <div>
        <form>
          <select id="titel" name="titel">
            <option value="Dhr.">Dhr.</option>
            <option value="Mevr.">Mevr.</option>
            <option value="niks"></option>
          </select>

          <label for="voornaam">Voornaam:</label>
          <input type="text" id="voornaam" />

          <label for="achternaam">Achternaam:</label>
          <input type="text" id="achternaam" />

          <label for="email">E-mailadres:</label>
          <input type="text" id="email" />

          <label for="adres">Adres:</label>
          <input type="text" id="adres" />

          <label for="geboortedatum">Geboortedatum:</label>
          <input type="date" id="geboortedatum" />

          <label for="telefoonnummer">Telefoonnummer:</label>
          <input type="text" id="telefoonnummer" />

          <label for="owner">Opdrachtgever:</label>
          <input type="text" id="owner" />

          <input
            type="button"
            value="Voeg medewerker toe"
            onclick="addMedewerkertoDB()"
          />
          <br /><br />

          <table id="personenTabel" style="width:50%">
            <tr>
              <th>Aanhef</th>
              <th>Voornaam</th>
              <th>Achternaam</th>
              <th>E-mail</th>
              <th>Adres</th>
              <th>Geboortedatum</th>
              <th>Telefoonnummer</th>
              <th>Opdrachtgever</th>
            </tr>
          </table>
        </form>

        <button onclick="refreshTabel()">refreshing</button>
      </div>
    </div>
  </body>

  <script>
    function Getpersoon() {
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        var dePersoon = JSON.parse(this.responseText);
        var rString = "";
        for (var x = 0; x < dePersoon.length; x++) {
          rString +=
            dePersoon[x].id +
            dePersoon[x].titel +
            dePersoon[x].voornaam +
            dePersoon[x].achternaam +
            dePersoon[x].emailAdres +
            dePersoon[x].adres +
            dePersoon[x].geboortedatum +
            dePersoon[x].telefoonnummer +
            "<br>";
        }
        document.getElementById("persoon").innerHTML = rString;
      };
      xhr.open("GET", "http://localhost:8082/get", true);
      xhr.send();
    }

    function refreshTabel() {
      $.getJSON("http://localhost:8082/get", function(personen) {
        console.log(personen);
        for (const persoon of personen) {
          $("#personenTabel").append(`<tr>
                <td>${persoon.titel} </td>
                <td>${persoon.voornaam} </td>
                <td>${persoon.achternaam} </td>
                <td>${persoon.emailAdres} </td>
                <td>${persoon.adres} </td>
                <td>${persoon.geboorteDatum} </td>
                <td>${persoon.telefoonNummer} </td>
                <td>${persoon.owner} </td>
                </tr>`);
        }
      });
    }

    function addMedewerkertoDB() {
      var titel = document.getElementById("titel").value;
      var vNaam = document.getElementById("voornaam").value;
      var aNaam = document.getElementById("achternaam").value;
      var eMail = document.getElementById("email").value;
      var adres = document.getElementById("adres").value;
      var geboortedatum = document.getElementById("geboortedatum").value;
      var telefoonnummer = document.getElementById("telefoonnummer").value;
      var persoon = {};
      persoon.titel = titel;
      persoon.voornaam = vNaam;
      persoon.achternaam = aNaam;
      persoon.emailAdres = eMail;
      persoon.adres = adres;
      persoon.geboorteDatum = geboortedatum;
      persoon.telefoonNummer = telefoonnummer;
      console.log(persoon);

      var abc = JSON.stringify(persoon);
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        document.getElementById("persoon").innerHTML = this.responseText;
        Getpersoon();
      };
      xhr.open("POST", "http://localhost:8082/post", true);
      xhr.setRequestHeader("Content-type", "application/json");
      xhr.send(abc);
    }

    function deleteGebruiker() {
      var delGebruiker = document.getElementById("delGb").value;
      var url = "http://localhost:8082/delete/";
      var xhr = new XMLHttpRequest();
      xhr.open("DELETE", url + delGebruiker, true);
      xhr.onload = function() {
        var gebruiker = JSON.parse(xhr.responseText);
      };
      xhr.onreadystatechange = function() {
        Getpersoon();
      };
      xhr.send();
    }
    function updateGebruiker() {
      var url = "http://localhost:8082/update/";
      var input = document.getElementById("upPersoon").value;
      var persoon = {
        titel: document.getElementById("titel").value,
        voornaam: document.getElementById("voornaam").value,
        achternaam: document.getElementById("achternaam").value,
        emailAdres: document.getElementById("eMail").value,
        adres: document.getElementById("adres").value,
        geboorteDatum: document.getElementById("geboortedatum").value,
        telefoonNummer: document.getElementById("telefoonnummer").value
      };
      var up = JSON.stringify(persoon);
      var xhr = new XMLHttpRequest();
      xhr.open("PUT", url + input, true);
      xhr.setRequestHeader("Content-type", "application/json");
      xhr.onload = function() {
        var user = JSON.parse(xhr.responseText);
      };
      xhr.onreadystatechange = function() {
        Getpersoon();
      };
      xhr.send(up);
    }
    
//opdrachtgever
    function Getopdrachtgever() {
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        var deOpdrachtgever = JSON.parse(this.responseText);
        var rString = "";
        for (var x = 0; x < deOpdrachtgever.length; x++) {
          rString +=
            deOpdrachtgever[x].opdrachtgeverID +
            deOpdrachtgever[x].naamOpdrachtgever("<br>");
        }
        document.getElementById("opdrachtgever").innerHTML = rString;
      };
      xhr.open("GET", "http://localhost:8082/getbyidOpdrachtgever/", true);
      xhr.send();
    }

    function addOpdrachtgevertoDB() {
      var oNaam = document.getElementById("naamOpdrachtgever").value;
      var opdrachtgever = {};
      opdrachtgever.naamOpdrachtgever = oNaam;
      console.log(opdrachtgever);

      var abc = JSON.stringify(opdrachtgever);
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function() {
        document.getElementById("opdrachtgever").innerHTML = this.responseText;
        Getopdrachtgever();
      };
      xhr.open("POST", "http://localhost:8082/postopdrachtgever", true);
      xhr.setRequestHeader("Content-type", "application/json");
      xhr.send(abc);
    }
    function init() {
      //Getopdrachtgever();
      // Getpersoon();
      refreshTabel();
    }
    window.onload = init;
  </script>
</html>
